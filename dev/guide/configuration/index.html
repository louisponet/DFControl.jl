<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Configuration · DFControl.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://louisponet.github.io/DFControl.jl/stable/guide/configuration/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFControl.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>Configuration</a><ul class="internal"><li><a class="tocitem" href="#[Servers](@ref-servers_header)"><span>Servers</span></a></li><li><a class="tocitem" href="#Pseudopotentials"><span>Pseudopotentials</span></a></li><li><a class="tocitem" href="#[Environments](@ref-environments_header)"><span>Environments</span></a></li><li><a class="tocitem" href="#[Execs](@ref-execs_header)"><span>Execs</span></a></li><li><a class="tocitem" href="#Loading/Saving"><span>Loading/Saving</span></a></li></ul></li><li><a class="tocitem" href="../basic_tutorial/">Basic Tutorial</a></li><li><a class="tocitem" href="../advanced_tutorial/">Advanced Tutorial</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../jobs/">Jobs</a></li><li><a class="tocitem" href="../calculations/">Calculations</a></li><li><a class="tocitem" href="../servers/">Servers</a></li><li><a class="tocitem" href="../structure/">Structure</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting started</a></li><li class="is-active"><a href>Configuration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Configuration</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/louisponet/DFControl.jl/blob/master/docs/src/guide/configuration.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Configuration"><a class="docs-heading-anchor" href="#Configuration">Configuration</a><a id="Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration" title="Permalink"></a></h1><h2 id="[Servers](@ref-servers_header)"><a class="docs-heading-anchor" href="#[Servers](@ref-servers_header)"><a href="../servers/#servers_header">Servers</a></a><a id="[Servers](@ref-servers_header)-1"></a><a class="docs-heading-anchor-permalink" href="#[Servers](@ref-servers_header)" title="Permalink"></a></h2><p>Since <code>DFControl</code> utilizes a client-server rest-api model, each server will have its own local deamon running, which stores certain server-side items such as pseudopotentials, <a href="../jobs/#DFControl.Jobs.Environment"><code>Environments</code></a> and <a href="../calculations/#DFControl.Calculations.Exec"><code>Execs</code></a>.</p><p>First start by setting up your local server:</p><pre><code class="language-julia">Servers.configure_local()</code></pre><p>To set up another <a href="../servers/#DFControl.Servers.Server"><code>Server</code></a>, in this case with <code>name = &quot;daint&quot;</code> an interactive menu can be called like:</p><pre><code class="language-julia">Server(&quot;daint&quot;)</code></pre><p>This will set up all the required information and store it for later use. To start a <a href="../servers/#DFControl.Servers.Server"><code>Server</code></a> simply call <code>start(server)</code>, which will launch the daemon externally. Make sure that the <code>host</code> address points to a persistent server, i.e. if a cluster has multiple frontend nodes, find the ip address of one particular one, and set that one as the <code>host</code> address. During the setup of an external server, it may ask whether a <code>local_tunnel</code> should be created. If enabled, a persistent ssh tunnel will be created from the local machine to the target host through which the http requests will be sent. This is useful when the remote is behind an authentication firewall.</p><h2 id="Pseudopotentials"><a class="docs-heading-anchor" href="#Pseudopotentials">Pseudopotentials</a><a id="Pseudopotentials-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudopotentials" title="Permalink"></a></h2><p>Pseudopotentials are grouped in sets, which are stored for later ease of use. They can be set up using the <a href="#DFControl.Client.configure_pseudoset"><code>configure_pseudoset</code></a> function.</p><pre><code class="language-julia">configure_pseudoset(local_server(), &quot;set_name&quot;, &quot;/dir/to/pseudos&quot;)</code></pre><p>This will go through the specified directories and find files that follow the naming convention <code>element.x_y_z.xyz</code> e.g. <code>Si.pbesol-n-kjpaw_psl.0.1.UPF</code> or <code>si.pbesol-n-kjpaw_psl.0.1.UPF</code>.  If multiple are found, all will be stored and the required one can be later specified.</p><p>The pseudos will remain on the server where they are stored, and can be listed using <a href="#DFControl.Client.list_pseudosets"><code>list_pseudosets</code></a>. See <a href="../structure/#pseudo_header">Pseudo Potentials</a> for further usage details.</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.Client.configure_pseudoset" href="#DFControl.Client.configure_pseudoset"><code>DFControl.Client.configure_pseudoset</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">configure_pseudoset(server::Server, set_name::String, dir::String)</code></pre><p>Reads the specified <code>dir</code> and sets up the pseudos for <code>set</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/pseudos.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.Client.list_pseudosets" href="#DFControl.Client.list_pseudosets"><code>DFControl.Client.list_pseudosets</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">list_pseudosets(server::Server)</code></pre><p>Lists the pseudosets that have previously been set up.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/pseudos.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.Client.rm_pseudoset!" href="#DFControl.Client.rm_pseudoset!"><code>DFControl.Client.rm_pseudoset!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rm_pseudoset!(server::Server, set_name::String)</code></pre><p>Removes the pseudo set from the server.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/pseudos.jl#L44-L48">source</a></section></article><h2 id="[Environments](@ref-environments_header)"><a class="docs-heading-anchor" href="#[Environments](@ref-environments_header)"><a href="../jobs/#environments_header">Environments</a></a><a id="[Environments](@ref-environments_header)-1"></a><a class="docs-heading-anchor-permalink" href="#[Environments](@ref-environments_header)" title="Permalink"></a></h2><p>Environments specify the skeleton of the job script, i.e. which environment variables need to be set, which scheduler flags, etc. Here we will set up an environment and save it on the local <a href="../servers/#DFControl.Servers.Server"><code>Server</code></a>. Change the information according to your own setup.</p><pre><code class="language-julia">e = Environment(name=&quot;default&quot;, MPI_command=&quot;mpirun -np 4&quot;, scheduler_flags=[&quot;-N 1&quot;, &quot;--partition=parallel&quot;], exports=[&quot;OMP_NUM_THREADS=1&quot;])
save(local_server(), e)</code></pre><p>While not recommended because it doesn&#39;t always work, one can try to extract an environment from a preexisting jobscript using</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.Client.environment_from_jobscript" href="#DFControl.Client.environment_from_jobscript"><code>DFControl.Client.environment_from_jobscript</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">environment_from_jobscript([server::Server, name::String,] scriptpath::String)</code></pre><p>Tries to extract an <a href="../jobs/#DFControl.Jobs.Environment"><code>Environment</code></a> from a jobscript.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/job.jl#L429-L433">source</a></section></article><h2 id="[Execs](@ref-execs_header)"><a class="docs-heading-anchor" href="#[Execs](@ref-execs_header)"><a href="../calculations/#execs_header">Execs</a></a><a id="[Execs](@ref-execs_header)-1"></a><a class="docs-heading-anchor-permalink" href="#[Execs](@ref-execs_header)" title="Permalink"></a></h2><p>An <a href="../calculations/#DFControl.Calculations.Exec"><code>Exec</code></a> embodies an executable as the name suggests. They hold both the executable, directory and modules required to run the executable. Similar to <a href="../jobs/#DFControl.Jobs.Environment"><code>Environments</code></a>, they are stored on the server for later use. When storing it is verified that they are able to run.</p><pre><code class="language-julia">e = Exec(name=&quot;pw&quot;, exec=&quot;pw.x&quot;, dir=&quot;/home/user/Softare/qe/bin&quot;, modules = [&quot;intel&quot;, &quot;intel-mpi&quot;, &quot;intel-mkl&quot;])
save(local_server(), e)</code></pre><h2 id="Loading/Saving"><a class="docs-heading-anchor" href="#Loading/Saving">Loading/Saving</a><a id="Loading/Saving-1"></a><a class="docs-heading-anchor-permalink" href="#Loading/Saving" title="Permalink"></a></h2><p>As shown above there are three main methods related to storing and retrieving data i.e.:</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.Database.load" href="#DFControl.Database.load"><code>DFControl.Database.load</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">load([server::Server], e::Environment)
load([server::Server], e::Exec)
load([server::Server], s::Server)</code></pre><p>Loads a previously stored item from the <code>server</code>. If <code>server</code> is not specified the local item is loaded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Database/Database.jl#L38-L44">source</a></section><section><div><pre><code class="language-julia">load(server::Server, j::Job)</code></pre><p>Tries to load the <a href="#DFControl.Jobs.Job"><code>Job</code></a> from <code>server</code> at directory <code>j.dir</code>. If no exact matching directory is found, a list of job directories that comprise <code>j.dir</code> will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/job.jl#L4-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.Database.save" href="#DFControl.Database.save"><code>DFControl.Database.save</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">save([server::Server], e::Environment)
save([server::Server], e::Exec)
save([server::Server], s::Server)</code></pre><p>Saves an item to the database of <code>server</code>. If <code>server</code> is not specified the item will be stored in the local database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Database/Database.jl#L17-L23">source</a></section><section><div><pre><code class="language-julia">save(job::Job)</code></pre><p>Saves the job&#39;s calculations and <code>job.sh</code> submission script in <code>job.dir</code>. Some sanity checks will be performed on the validity of flags, execs, pseudopotentials, etc. The job will also be registered for easy retrieval at a later stage.</p><p>If a previous job is present in the job directory (indicated by a valid job script), it will be copied to the <code>.versions</code> sub directory as the previous version of <code>job</code>, and the version of <code>job</code> will be incremented. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Client/job.jl#L128-L138">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.Filesystem.rm-Tuple{Storable}" href="#Base.Filesystem.rm-Tuple{Storable}"><code>Base.Filesystem.rm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">Base.rm([server::Server], e::Environment)
Base.rm([server::Server], e::Exec)
Base.rm([server::Server], s::Server)</code></pre><p>Removes an item from the database of <code>server</code>. If <code>server</code> is not specified the item will removed from the local database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/59154acbe3a6f5da6d12087bac8aae48bbca49e7/src/Database/Database.jl#L121-L127">source</a></section></article><p>After completing this configuration, it is suggested to look at the (Basic Usage)[@ref] for an introduction to the basic usage of <code>DFControl</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">« Installation</a><a class="docs-footer-nextpage" href="../basic_tutorial/">Basic Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Saturday 24 September 2022 11:33">Saturday 24 September 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

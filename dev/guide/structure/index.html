<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Structure · DFControl.jl</title><link rel="canonical" href="https://louisponet.github.io/DFControl.jl/stable/guide/structure/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DFControl.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../basic_tutorial/">Basic Tutorial</a></li><li><a class="tocitem" href="../advanced_tutorial/">Advanced Tutorial</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../jobs/">Jobs</a></li><li><a class="tocitem" href="../calculations/">Calculations</a></li><li class="is-active"><a class="tocitem" href>Structure</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Symmetries"><span>Symmetries</span></a></li><li><a class="tocitem" href="#Cell"><span>Cell</span></a></li><li><a class="tocitem" href="#Atom"><span>Atom</span></a></li><li><a class="tocitem" href="#Element"><span>Element</span></a></li><li><a class="tocitem" href="#pseudo_header"><span>Pseudo Potentials</span></a></li><li><a class="tocitem" href="#Magnetization"><span>Magnetization</span></a></li><li><a class="tocitem" href="#Projections"><span>Projections</span></a></li><li><a class="tocitem" href="#DFT-U"><span>DFT + U</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Structure</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Structure</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/louisponet/DFControl.jl/blob/master/docs/src/guide/structure.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Structure"><a class="docs-heading-anchor" href="#Structure">Structure</a><a id="Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Structure" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Structure">Structure</a></li><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Symmetries">Symmetries</a></li><li><a href="#Cell">Cell</a></li><li><a href="#Atom">Atom</a></li><li><a href="#Element">Element</a></li><li><a href="#pseudo_header">Pseudo Potentials</a></li><li><a href="#Magnetization">Magnetization</a></li><li><a href="#Projections">Projections</a></li><li><a href="#DFT-U">DFT + U</a></li></ul></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#DFControl.Atom"><code>DFControl.Atom</code></a></li><li><a href="#DFControl.DFTU"><code>DFControl.DFTU</code></a></li><li><a href="#DFControl.Element"><code>DFControl.Element</code></a></li><li><a href="#DFControl.Orbital"><code>DFControl.Orbital</code></a></li><li><a href="#DFControl.Projection"><code>DFControl.Projection</code></a></li><li><a href="#DFControl.Pseudo"><code>DFControl.Pseudo</code></a></li><li><a href="#DFControl.Structure"><code>DFControl.Structure</code></a></li><li><a href="#Base.getindex-Tuple{Structure, Int64}"><code>Base.getindex</code></a></li><li><a href="#DFControl.a"><code>DFControl.a</code></a></li><li><a href="#DFControl.atoms-Tuple{Structure}"><code>DFControl.atoms</code></a></li><li><a href="#DFControl.b"><code>DFControl.b</code></a></li><li><a href="#DFControl.c"><code>DFControl.c</code></a></li><li><a href="#DFControl.cell_parameters"><code>DFControl.cell_parameters</code></a></li><li><a href="#DFControl.configuredefault_pseudos"><code>DFControl.configuredefault_pseudos</code></a></li><li><a href="#DFControl.create_supercell"><code>DFControl.create_supercell</code></a></li><li><a href="#DFControl.element"><code>DFControl.element</code></a></li><li><a href="#DFControl.getdefault_pseudo"><code>DFControl.getdefault_pseudo</code></a></li><li><a href="#DFControl.high_symmetry_kpath"><code>DFControl.high_symmetry_kpath</code></a></li><li><a href="#DFControl.high_symmetry_kpoints"><code>DFControl.high_symmetry_kpoints</code></a></li><li><a href="#DFControl.international"><code>DFControl.international</code></a></li><li><a href="#DFControl.niggli_reduce"><code>DFControl.niggli_reduce</code></a></li><li><a href="#DFControl.orbital"><code>DFControl.orbital</code></a></li><li><a href="#DFControl.polyhedron"><code>DFControl.polyhedron</code></a></li><li><a href="#DFControl.scale_cell!"><code>DFControl.scale_cell!</code></a></li><li><a href="#DFControl.set_Hubbard_J!"><code>DFControl.set_Hubbard_J!</code></a></li><li><a href="#DFControl.set_Hubbard_J0!"><code>DFControl.set_Hubbard_J0!</code></a></li><li><a href="#DFControl.set_Hubbard_U!"><code>DFControl.set_Hubbard_U!</code></a></li><li><a href="#DFControl.set_Hubbard_α!"><code>DFControl.set_Hubbard_α!</code></a></li><li><a href="#DFControl.set_Hubbard_β!"><code>DFControl.set_Hubbard_β!</code></a></li><li><a href="#DFControl.set_magnetization!"><code>DFControl.set_magnetization!</code></a></li><li><a href="#DFControl.set_position!"><code>DFControl.set_position!</code></a></li><li><a href="#DFControl.set_projections!"><code>DFControl.set_projections!</code></a></li><li><a href="#DFControl.set_pseudo!"><code>DFControl.set_pseudo!</code></a></li><li><a href="#DFControl.set_pseudos!"><code>DFControl.set_pseudos!</code></a></li><li><a href="#DFControl.setdefault_pseudodir"><code>DFControl.setdefault_pseudodir</code></a></li><li><a href="#DFControl.symmetry_operators"><code>DFControl.symmetry_operators</code></a></li><li><a href="#DFControl.update_geometry!"><code>DFControl.update_geometry!</code></a></li><li><a href="#DFControl.volume"><code>DFControl.volume</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="DFControl.Structure" href="#DFControl.Structure"><code>DFControl.Structure</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Structure([name::String,] cell::Mat3, atoms::Vector{&lt;:AbstractAtom}[, data::Dict{Symbol,Any}])</code></pre><p>The structure on which the <a href="../calculations/#DFControl.DFCalculation"><code>DFCalculations</code></a> will be performed.</p><pre><code class="nohighlight">Structure(cif_file::String; name = &quot;NoName&quot;)</code></pre><p>Creates a <a href="#DFControl.Structure"><code>Structure</code></a> from the supplied cif file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L116-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Tuple{Structure, Int64}" href="#Base.getindex-Tuple{Structure, Int64}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getindex(structure::AbstractStructure, i::Int)
getindex(structure::AbstractStructure, name::Symbol)
getindex(structure::AbstractStructure, el::Element)</code></pre><p>Returns the <code>i</code>th atom in <code>structure</code>, or all atoms with <code>name</code> or are of element <code>el</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L184-L190">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.update_geometry!" href="#DFControl.update_geometry!"><code>DFControl.update_geometry!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">update_geometry!(str1::AbstractStructure, str2::AbstractStructure)
update_geometry!(job::DFJob, str2::AbstractStructure)</code></pre><p>Updates the spatial parameters of the <code>atoms</code> and <code>cell</code> of the first structure to those found in the second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L39-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.polyhedron" href="#DFControl.polyhedron"><code>DFControl.polyhedron</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">polyhedron(at::AbstractAtom, atoms::Vector{&lt;:AbstractAtom}, order::Int)
polyhedron(at::AbstractAtom, str::AbstractStructure, order::Int)</code></pre><p>Returns a polyhedron around the atom, i.e. the <code>order</code> closest atoms. The returned atoms will be ordered according to their distance to the first one. In the case of a structure rather than a set of atoms, the search will be performed over all atoms in the structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L256-L264">source</a></section></article><h2 id="Symmetries"><a class="docs-heading-anchor" href="#Symmetries">Symmetries</a><a id="Symmetries-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetries" title="Permalink"></a></h2><p>This functionality relies on <code>spglib</code> to find the symmetries of the <code>Structure</code> and  supply various related quantities.</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.high_symmetry_kpath" href="#DFControl.high_symmetry_kpath"><code>DFControl.high_symmetry_kpath</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">high_symmetry_kpath(s::AbstractStructure, npoints_per_segment::Int; package=QE, kwargs...)
high_symmetry_kpath(j::DFJob, npoints_per_segment::Int; package=QE, kwargs...)</code></pre><p>Generates a QE bands calculation compliant high symmetry kpath, to be used with e.g. <code>set_kpoints!(bands_calculation, kpoints)</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L429-L435">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.high_symmetry_kpoints" href="#DFControl.high_symmetry_kpoints"><code>DFControl.high_symmetry_kpoints</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">high_symmetry_kpoints(s::Structure; tolerance = 1e-5)
high_symmetry_kpoints(j::DFJob; tolerance = 1e-5)</code></pre><p>Returns <code>(kpoints, path)</code> where <code>kpoints</code> are the high-symmetry k-points, and <code>path</code> are the sections of the high symmetry path through the first Brillouin Zone.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L456-L462">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.international" href="#DFControl.international"><code>DFControl.international</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">international(j::DFJob; tolerance=1.0e-5)
international(s::Structure; tolerance=1.0e-5)</code></pre><p>Returns the international symbol of the space group of the structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L309-L314">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.niggli_reduce" href="#DFControl.niggli_reduce"><code>DFControl.niggli_reduce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">niggli_reduce(j::DFJob; tolerance=1.0e-5)
niggli_reduce(s::Structure; tolerance=1.0e-5)</code></pre><p>Returns the niggli reduced <code>Structure</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L329-L334">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.symmetry_operators" href="#DFControl.symmetry_operators"><code>DFControl.symmetry_operators</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">symmetry_operators(j::DFJob; maxsize=52, tolerance=1.0e-5)
symmetry_operators(s::Structure; maxsize=52, tolerance=1.0e-5)</code></pre><p>Finds and returns all the rotations and translations that are symmetry operators of the structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L289-L294">source</a></section></article><h2 id="Cell"><a class="docs-heading-anchor" href="#Cell">Cell</a><a id="Cell-1"></a><a class="docs-heading-anchor-permalink" href="#Cell" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The lattice vectors are stored as the <em>columns</em> of the <code>cell</code>.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="DFControl.a" href="#DFControl.a"><code>DFControl.a</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">a(str::AbstractStructure)</code></pre><p>First lattice vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.b" href="#DFControl.b"><code>DFControl.b</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">b(str::AbstractStructure)</code></pre><p>Second lattice vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L112-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.c" href="#DFControl.c"><code>DFControl.c</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">c(str::AbstractStructure)</code></pre><p>Third lattice vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.cell_parameters" href="#DFControl.cell_parameters"><code>DFControl.cell_parameters</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">cell_parameters(cell::Mat3)
cell_parameters(str::Structure)</code></pre><p>Parameters <code>(a, b, c, α, β, γ)</code>of the calculation cell returned in a <code>NamedTuple</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L387-L392">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.volume" href="#DFControl.volume"><code>DFControl.volume</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">volume(cell::Mat3)
volume(str::Structure)
volume(job::DFJob)</code></pre><p>Calculates the volume for the unit cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L93-L99">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.create_supercell" href="#DFControl.create_supercell"><code>DFControl.create_supercell</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">create_supercell(structure::AbstractStructure, na::Int, nb::Int, nc::Int; make_afm=false)
create_supercell(structure::AbstractStructure, na::UnitRange, nb::UnitRange, nc::UnitRange; make_afm=false)</code></pre><p>Takes a structure and creates a supercell from it with: the given amount of additional cells if (<code>na::Int, nb::Int, nc::Int</code>) along the a, b, c direction, or amount of cells specified by the ranges i.e. <code>-1:1, -1:1, -1:1</code> would create a 3x3x3 supercell. If <code>make_afm</code> is set to <code>true</code> all the labels and magnetizations of the magnetic atoms will be reversed in a checkerboard fashion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L125-L131">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.scale_cell!" href="#DFControl.scale_cell!"><code>DFControl.scale_cell!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">scale_cell!(structure::Structure, scalemat::Matrix)
scale_cell!(job::DFJob, scalemat::Matrix)</code></pre><p>Rescales the cell of the <code>structure</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/structure.jl#L171-L176">source</a></section></article><h2 id="Atom"><a class="docs-heading-anchor" href="#Atom">Atom</a><a id="Atom-1"></a><a class="docs-heading-anchor-permalink" href="#Atom" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.Atom" href="#DFControl.Atom"><code>DFControl.Atom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Atom(name::Symbol, element::Element, position_cart::Point3{Length}, position_cryst::Point3;
     pseudo::Pseudo = Pseudo(),
     projections::Vector{Projection} = Projection[],
     magnetization::Vec3 = Vec3(0.0, 0.0, 0.0),
     dftu::DFTU = DFTU())</code></pre><p>Representation of an <code>atom</code>.</p><p>The <code>name</code> of the <code>atom</code> is used as an identifier for the <code>atom</code> type, in the sense that atoms with the same <code>pseudo</code>, <code>projections</code>, <code>magnetization</code> and <a href="#DFControl.DFTU"><code>dftu</code></a> attributes should belong to the same type. This also means that during sanity checks atoms that are not of the same type will be given different names. This is done in this way because it often makes sense to change these parameters on all atoms of the same kind at the same time, but still allow the flexibility to change them for individual atoms as well.</p><p><code>position_cart</code> should have a valid <code>Unitful.Length</code> type such as <code>Ang</code>.</p><p>See documentation for <a href="#DFControl.Element"><code>Element</code></a> and <a href="#DFControl.Pseudo"><code>Pseudo</code></a> for further information on these attributes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L74-L88">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.atoms-Tuple{Structure}" href="#DFControl.atoms-Tuple{Structure}"><code>DFControl.atoms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">atoms([f::Function,], structure::AbstractStructure)</code></pre><p>Returns <code>structure.atoms</code> or <code>filter(f, structure.atoms)</code> if <code>f</code> is specified.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L101-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_position!" href="#DFControl.set_position!"><code>DFControl.set_position!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_position!(at::AbstractAtom, pos::AbstractVector{T}, unit_cell::Mat3) where {T&lt;:Real}</code></pre><p>Updates the position of the atom to this. The unit cell is used to make sure both <code>position_cryst</code> and <code>position_cart</code> are correct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L199-L203">source</a></section></article><h2 id="Element"><a class="docs-heading-anchor" href="#Element">Element</a><a id="Element-1"></a><a class="docs-heading-anchor-permalink" href="#Element" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.Element" href="#DFControl.Element"><code>DFControl.Element</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Element(symbol::Symbol, Z::Int, name::String, atomic_weight::Float64, color::NTuple{3, Float64})</code></pre><p>Represents an element. Most conveniently used trough the function <a href="#DFControl.element"><code>element</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L58-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.element" href="#DFControl.element"><code>DFControl.element</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">element(sym::Symbol)</code></pre><p>Returns the predefined <a href="#DFControl.Element"><code>Element</code></a> with symbol <code>sym</code>, i.e. <code>element(:Si)</code> will return the pregenerated Silicon <a href="#DFControl.Element"><code>Element</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L19-L24">source</a></section></article><h2 id="pseudo_header"><a class="docs-heading-anchor" href="#pseudo_header">Pseudo Potentials</a><a id="pseudo_header-1"></a><a class="docs-heading-anchor-permalink" href="#pseudo_header" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.Pseudo" href="#DFControl.Pseudo"><code>DFControl.Pseudo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Pseudo(name::String, dir::String)</code></pre><p>A pseudo potential file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_pseudo!" href="#DFControl.set_pseudo!"><code>DFControl.set_pseudo!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_pseudo!(at::AbstractAtom, pseudo::Pseudo; print=true)</code></pre><p>Sets the pseudopotential <code>at</code> to <code>pseudo</code>, and the validity of the <code>Pseudo</code> is checked.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L236-L240">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_pseudos!" href="#DFControl.set_pseudos!"><code>DFControl.set_pseudos!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_pseudos!(job::DFJob, set::Symbol, specifier::String=&quot;&quot;; kwargs...)
set_pseudos!(structure::AbstractStructure, set::Symbol, specifier::String=&quot;&quot;; kwargs...)
set_pseudos!(job::DFJob, atsym::Symbol, set::Symbol, specifier::String=&quot;&quot;; kwargs...)
set_pseudos!(structure::AbstractStructure, atsym::Symbol, set::Symbol, specifier::String=&quot;&quot;; kwargs...)</code></pre><p>Sets the pseudopotentials of the atoms inside the <code>structure</code> (or <code>job.structure</code>) to the ones of <code>set</code>. <code>specifier</code> can be specified to select a specific pseudo if multiple pseudopotentials for a given element exist in the set. Example:</p><pre><code class="nohighlight">set_pseudos!(job, :pbesol, &quot;rrkjus&quot;)</code></pre><p>will select the pseudo file that contains &quot;rrkjus&quot; in the filename.</p><p>If <code>atsym</code> is used, only the pseudos of the atoms with that name will be set.</p><pre><code class="nohighlight">set_pseudos!(job::DFJob, at_pseudos::Pair{Symbol, Pseudo}...; kwargs...)
set_pseudos!(structure::AbstractStructure, at_pseudos::Pair{Symbol, Pseudo}...; kwargs...)</code></pre><p>Convenience function that allows to set pseudopotentials for multiple atom types at the same time. e.g. `set<em>pseudos!(job, :Si =&gt; getdefault</em>pseudo(:Si, :sssp)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L247-L269">source</a></section><section><div><p>sets the pseudopotentials for the atom with name <code>atsym</code> to the specified one in the default pseudoset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L274">source</a></section><section><div><p>sets the pseudopotentials to the specified one in the default pseudoset.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L280">source</a></section></article><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"></div></div><p>If pseudopotentials from different sets/directories are specified for the atoms, they will be  copied to the <code>DFJob</code> <code>local_dir</code>.</p><h3 id="Pseudo-sets"><a class="docs-heading-anchor" href="#Pseudo-sets">Pseudo sets</a><a id="Pseudo-sets-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudo-sets" title="Permalink"></a></h3><p>See the section on <a href="../configuration/#Configuration">Configuration</a> for a demonstration on how to set up pseudopotential sets.</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.getdefault_pseudo" href="#DFControl.getdefault_pseudo"><code>DFControl.getdefault_pseudo</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">getdefault_pseudo(atom::Symbol, set=:default; specifier=nothing)</code></pre><p>Returns the pseudo potential string linked to the atom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/defaults.jl#L151-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.setdefault_pseudodir" href="#DFControl.setdefault_pseudodir"><code>DFControl.setdefault_pseudodir</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">setdefault_pseudodir(pseudo_symbol::Symbol, dir::String)</code></pre><p>Adds an entry inside the <code>default_pseudodirs</code> with flag <code>pseudo_symbol</code>, and adds it to the <code>user_defaults.jl</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/defaults.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.configuredefault_pseudos" href="#DFControl.configuredefault_pseudos"><code>DFControl.configuredefault_pseudos</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">configuredefault_pseudos(server = getdefault_server(), pseudo_dirs=getdefault_pseudodirs())</code></pre><p>Reads the specified <code>default_pseudo_dirs</code> on the <code>default_server</code> and sets up the <code>default_pseudos</code> variable, and also adds all the entries to the <code>user_defaults.jl</code> file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/defaults.jl#L101-L105">source</a></section></article><h2 id="Magnetization"><a class="docs-heading-anchor" href="#Magnetization">Magnetization</a><a id="Magnetization-1"></a><a class="docs-heading-anchor-permalink" href="#Magnetization" title="Permalink"></a></h2><p>Magnetization can be set on a per <a href="#Atom"><code>Atom</code></a> basis. It will partially determine the unique <a href="#Atom"><code>Atom</code></a> types and also what calculation flags should be set in order to allow for the  magnetic calculation (either colinear or non-colinear).</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_magnetization!" href="#DFControl.set_magnetization!"><code>DFControl.set_magnetization!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_magnetization!(at::AbstractAtom, mag; print=true)</code></pre><p>Sets the magnetization of the <a href="#Atom"><code>Atom</code></a>.</p><pre><code class="nohighlight">set_magnetization!(str::Structure, atsym_mag::Pair{Symbol,&lt;:AbstractVector}...)
set_magnetization!(job::DFJob, atsym_mag::Pair{Symbol,&lt;:AbstractVector}...)</code></pre><p>Each of the names in <code>atsym_mag</code> will be matched with the <a href="#Atom"><code>Atoms</code></a> and their magnetization will be set to the specified ones.</p><p>Example:</p><pre><code class="nohighlight">set_magnetization!(job, :Ni1 =&gt; [0.0, 0.0, -1.0], :Ni2 =&gt; [0.0, 0.0, 1.0])</code></pre><p>will set all the moments of <a href="#Atom"><code>Atoms</code></a> with name <code>Ni1</code> to <code>[0.0, 0.0, -1.0]</code> and <code>Ni2</code> to <code>[0.0, 0.0, 1.0]</code>. Since the moments are aligned with the z-direction this will signal that colinear calculations should be ran.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L152-L169">source</a></section></article><h2 id="Projections"><a class="docs-heading-anchor" href="#Projections">Projections</a><a id="Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Projections" title="Permalink"></a></h2><p>These projections will mainly be used for generating Wannier90 inputs, and to distinguish which indices in the Wannier90 output matrices correspond to the various atoms/orbitals.</p><article class="docstring"><header><a class="docstring-binding" id="DFControl.Projection" href="#DFControl.Projection"><code>DFControl.Projection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Projection(orb::Orbital, start::Int, last::Int)</code></pre><p>A Wannier90 <code>Projection</code>, representing an <code>Orbital</code> with indices from <code>start</code> to <code>last</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_projections!" href="#DFControl.set_projections!"><code>DFControl.set_projections!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_projections!(at::AbstractAtom, projections::Vector{Projection}; print=true)</code></pre><p>Sets the projections of the atom.</p><pre><code class="nohighlight">set_projections!(str::Structure, projs::Pair...; soc=false)
set_projections!(job::DFJob, projs::Pair...; kwargs...)</code></pre><p>Sets the projections of the specified atoms. <code>projs</code> has to be of form <code>:atsym =&gt; [:proj]</code>, where <code>proj = &quot;s&quot;, &quot;p&quot;, &quot;d&quot;, &quot;f&quot;</code>, see <a href="#Orbitals">Orbital</a> to see which projections are allowed.  If <code>soc</code> is set to <code>true</code> both up and down projections will be taken into account.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The previously existing projections will be overwritten when using the last two functions.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/wannier90/projections.jl#L71-L85">source</a></section></article><h3 id="Orbitals"><a class="docs-heading-anchor" href="#Orbitals">Orbitals</a><a id="Orbitals-1"></a><a class="docs-heading-anchor-permalink" href="#Orbitals" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="DFControl.Orbital" href="#DFControl.Orbital"><code>DFControl.Orbital</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Orbital(name::String, size::Int, l::Int, mr::Int)</code></pre><p>Wannier90 orbital as defined in the <a href="https://github.com/wannier-developers/wannier90/raw/v3.1.0/doc/compiled_docs/user_guide.pdf">Wannier90 User Guide</a>. The <code>name</code> will be written in the <code>projections</code> block of the Wannier90 input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.orbital" href="#DFControl.orbital"><code>DFControl.orbital</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">orbital(s::String)</code></pre><p>Returns the <a href="#Orbitals">Orbital</a> identified by <code>s</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/wannier90/projections.jl#L11-L15">source</a></section></article><h2 id="DFT-U"><a class="docs-heading-anchor" href="#DFT-U">DFT + U</a><a id="DFT-U-1"></a><a class="docs-heading-anchor-permalink" href="#DFT-U" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.DFTU" href="#DFControl.DFTU"><code>DFControl.DFTU</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DFTU(;l ::Int = -1,
      U ::T   = zero(T),
      J0::T  = zero(T),
      α ::T   = zero(T),
      β ::T   = zero(T),
      J ::Vector{T} = T[zero(T)])</code></pre><p>DFT+U parameters for a given <a href="#DFControl.Atom"><code>Atom</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/types.jl#L26-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_Hubbard_U!" href="#DFControl.set_Hubbard_U!"><code>DFControl.set_Hubbard_U!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>Hubbard</em>U!(at::AbstractAtom, v::AbstractFloat; print=true)          set<em>Hubbard</em>U!(job::DFJob, ats_Us::Pair{Symbol, &lt;:AbstractFloat}...; print=true)</p><pre><code class="nohighlight"> Set the Hubbard U parameter for the specified [Atoms](@ref Atom).
 The latter function allows for conveniently setting the parameter for all
 [Atoms](@ref Atom) with the specified `name`.

 Example:
     `set_Hubbard_U!(job, :Ir =&gt; 2.1, :Ni =&gt; 1.0, :O =&gt; 0.0)`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L325">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_Hubbard_J0!" href="#DFControl.set_Hubbard_J0!"><code>DFControl.set_Hubbard_J0!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>Hubbard</em>J0!(at::AbstractAtom, v::AbstractFloat; print=true)          set<em>Hubbard</em>J0!(job::DFJob, ats_J0s::Pair{Symbol, &lt;:AbstractFloat}...; print=true)</p><pre><code class="nohighlight"> Set the Hubbard J0 parameter for the specified [Atoms](@ref Atom).
 The latter function allows for conveniently setting the parameter for all
 [Atoms](@ref Atom) with the specified `name`.

 Example:
     `set_Hubbard_J0!(job, :Ir =&gt; 2.1, :Ni =&gt; 1.0, :O =&gt; 0.0)`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L325">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_Hubbard_α!" href="#DFControl.set_Hubbard_α!"><code>DFControl.set_Hubbard_α!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>Hubbard</em>α!(at::AbstractAtom, v::AbstractFloat; print=true)          set<em>Hubbard</em>α!(job::DFJob, ats_αs::Pair{Symbol, &lt;:AbstractFloat}...; print=true)</p><pre><code class="nohighlight"> Set the Hubbard α parameter for the specified [Atoms](@ref Atom).
 The latter function allows for conveniently setting the parameter for all
 [Atoms](@ref Atom) with the specified `name`.

 Example:
     `set_Hubbard_α!(job, :Ir =&gt; 2.1, :Ni =&gt; 1.0, :O =&gt; 0.0)`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L325">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_Hubbard_β!" href="#DFControl.set_Hubbard_β!"><code>DFControl.set_Hubbard_β!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>set<em>Hubbard</em>β!(at::AbstractAtom, v::AbstractFloat; print=true)          set<em>Hubbard</em>β!(job::DFJob, ats_βs::Pair{Symbol, &lt;:AbstractFloat}...; print=true)</p><pre><code class="nohighlight"> Set the Hubbard β parameter for the specified [Atoms](@ref Atom).
 The latter function allows for conveniently setting the parameter for all
 [Atoms](@ref Atom) with the specified `name`.

 Example:
     `set_Hubbard_β!(job, :Ir =&gt; 2.1, :Ni =&gt; 1.0, :O =&gt; 0.0)`</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L325">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_Hubbard_J!" href="#DFControl.set_Hubbard_J!"><code>DFControl.set_Hubbard_J!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_Hubbard_J!(at::AbstractAtom, v::Vector{&lt;:AbstractFloat}; print=true)
set_Hubbard_J!(job::DFJob, ats_Js::Pair{Symbol, Vector{&lt;:AbstractFloat}}...; print=true)</code></pre><p>Set the Hubbard J parameter for the specified atom. The latter function allows for conveniently setting the <code>Hubbard_J</code> for all <a href="#Atom">Atoms</a> with the specified <code>name</code>.</p><p>Example: 	<code>set_Hubbard_J(at, [2.1])&#39;</code>set<em>Hubbard</em>J(job, :Ir =&gt; [2.1], :Ni =&gt; [1.0])&#39;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/a5b76b4e0643393a3f0aa3e32fa08ff66e360f49/src/atom.jl#L349-L360">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../calculations/">« Calculations</a><a class="docs-footer-nextpage" href="../../api/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 28 June 2021 12:36">Monday 28 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

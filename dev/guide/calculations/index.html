<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Calculations · DFControl.jl</title><link rel="canonical" href="https://louisponet.github.io/DFControl.jl/stable/guide/calculations/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DFControl.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../basic_tutorial/">Basic Tutorial</a></li><li><a class="tocitem" href="../advanced_tutorial/">Advanced Tutorial</a></li></ul></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../jobs/">Jobs</a></li><li class="is-active"><a class="tocitem" href>Calculations</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Basic-interaction"><span>Basic interaction</span></a></li><li><a class="tocitem" href="#Flags"><span>Flags</span></a></li><li><a class="tocitem" href="#Execs"><span>Execs</span></a></li><li><a class="tocitem" href="#calculation_generation"><span>Generating new calculations</span></a></li><li><a class="tocitem" href="#Output"><span>Output</span></a></li></ul></li><li><a class="tocitem" href="../structure/">Structure</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Usage</a></li><li class="is-active"><a href>Calculations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Calculations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/louisponet/DFControl.jl/blob/master/docs/src/guide/calculations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Calculations"><a class="docs-heading-anchor" href="#Calculations">Calculations</a><a id="Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Calculations" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Calculations">Calculations</a></li><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Basic-interaction">Basic interaction</a></li><li><a href="#Flags">Flags</a></li><li><a href="#Execs">Execs</a></li><li><a href="#calculation_generation">Generating new calculations</a></li><li><a href="#Output">Output</a></li></ul></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#DFControl.DFCalculation"><code>DFControl.DFCalculation</code></a></li><li><a href="#DFControl.Exec"><code>DFControl.Exec</code></a></li><li><a href="#DFControl.InputData"><code>DFControl.InputData</code></a></li><li><a href="#Base.getindex-Tuple{DFCalculation, Symbol}"><code>Base.getindex</code></a></li><li><a href="#Base.setindex!-Tuple{DFCalculation, Symbol, Any}"><code>Base.setindex!</code></a></li><li><a href="#DFControl.data"><code>DFControl.data</code></a></li><li><a href="#DFControl.exec"><code>DFControl.exec</code></a></li><li><a href="#DFControl.execs"><code>DFControl.execs</code></a></li><li><a href="#DFControl.gencalc_bands-Tuple{DFCalculation{QE}, Vector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:(NTuple{4, T} where T), Vararg{Any, N} where N}"><code>DFControl.gencalc_bands</code></a></li><li><a href="#DFControl.gencalc_nscf-Tuple{DFCalculation{QE}, Tuple{Int64, Int64, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_nscf</code></a></li><li><a href="#DFControl.gencalc_projwfc-Tuple{DFCalculation{QE}, Real, Real, Real}"><code>DFControl.gencalc_projwfc</code></a></li><li><a href="#DFControl.gencalc_scf-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_scf</code></a></li><li><a href="#DFControl.gencalc_vcrelax-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_vcrelax</code></a></li><li><a href="#DFControl.gencalc_wan"><code>DFControl.gencalc_wan</code></a></li><li><a href="#DFControl.outputdata"><code>DFControl.outputdata</code></a></li><li><a href="#DFControl.readbands"><code>DFControl.readbands</code></a></li><li><a href="#DFControl.readfermi"><code>DFControl.readfermi</code></a></li><li><a href="#DFControl.rm_execflags!"><code>DFControl.rm_execflags!</code></a></li><li><a href="#DFControl.rm_flags!"><code>DFControl.rm_flags!</code></a></li><li><a href="#DFControl.set_data!"><code>DFControl.set_data!</code></a></li><li><a href="#DFControl.set_data_option!"><code>DFControl.set_data_option!</code></a></li><li><a href="#DFControl.set_execdir!"><code>DFControl.set_execdir!</code></a></li><li><a href="#DFControl.set_execflags!"><code>DFControl.set_execflags!</code></a></li><li><a href="#DFControl.set_flags!"><code>DFControl.set_flags!</code></a></li><li><a href="#DFControl.set_kpoints!"><code>DFControl.set_kpoints!</code></a></li><li><a href="#DFControl.set_name!"><code>DFControl.set_name!</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="DFControl.DFCalculation" href="#DFControl.DFCalculation"><code>DFControl.DFCalculation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DFCalculation{P&lt;:Package}(name    ::String;
                          dir     ::String = &quot;&quot;,
                          flags   ::AbstractDict = Dict{Symbol, Any}(),
                          data    ::Vector{InputData} = InputData[],
                          execs   ::Vector{Exec},
                          run     ::Bool = true,
                          outdata ::AbstractDict = Dict{Symbol, Any}(),
                          infile  ::String = P == Wannier90 ? name * &quot;.win&quot; : name * &quot;.in&quot;,
                          outfile ::String = name * &quot;.out&quot;)</code></pre><p>The representation of a <em>DFT</em> calculation of package <code>P</code>, holding the <code>flags</code> that will be written to the <code>infile</code>, the executables in <code>execs</code> and the output written by the calculation to the <code>outfile</code>. It essentially represents a line in a job script similar to <code>exec1 exec2 &lt; infile.in &gt; outfile.out</code>.  <code>outdata</code> stores the parsed calculation output after it was read at least once. The <code>run</code> field indicates whether the calculation should be actually performed, e.g. if <code>run=false</code> the corresponding line will be commented out in the job script.</p><pre><code class="nohighlight">DFCalculation{P&lt;:Package}(name::AbstractString, flags::Pair{Symbol, Any}...; kwargs...)</code></pre><p>Create a <a href="#DFControl.DFCalculation"><code>DFCalculation</code></a> from <code>name</code> and <code>flags</code>, other <code>kwargs...</code> will be passed to the constructor.</p><pre><code class="nohighlight">DFCalculation(template::DFCalculation, name::AbstractString, flags::Pair{Symbol, Any}...; excs=deepcopy(execs(template)), run=true, data=nothing, dir=copy(template.dir))</code></pre><p>Creates a new <a href="#DFControl.DFCalculation"><code>DFCalculation</code></a> from the <code>template</code>, setting the <code>flags</code> of the newly created one to the specified ones.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/types.jl#L218-L244">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.InputData" href="#DFControl.InputData"><code>DFControl.InputData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">InputData(name::Symbol, option::Symbol, data::Any)</code></pre><p>Represents a more structured block of input data. e.g. <code>InputData(:k_points, :automatic, (6,6,6,1,1,1))</code> would be translated for a QE calculation into</p><pre><code class="nohighlight">K_POINTS(automatic)
6 6 6 1 1 1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/types.jl#L201-L211">source</a></section></article><h2 id="Basic-interaction"><a class="docs-heading-anchor" href="#Basic-interaction">Basic interaction</a><a id="Basic-interaction-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-interaction" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_name!" href="#DFControl.set_name!"><code>DFControl.set_name!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_name!(calculation::DFCalculation, name::AbstractString)</code></pre><p>Sets <code>calculation.name</code>, and <code>calculation.infile</code> and <code>calculation.outfile</code> to conform with the new <code>name</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.data" href="#DFControl.data"><code>DFControl.data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">data(calculation::DFCalculation)
data(calculation::DFCalculation, n::Symbol)</code></pre><p>The former returns <code>calculation.data</code>, the later – the <code>InputData</code> with name <code>n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L151-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_data!" href="#DFControl.set_data!"><code>DFControl.set_data!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_data!(calculation::DFCalculation, data::InputData)</code></pre><p>If an <code>InputData</code> with the same name as <code>data</code> is already in <code>calculation</code>, it will be overwritten. Otherwise <code>data</code> gets pushed to the list of <code>InputData</code> blocks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculation.jl#L78-L82">source</a></section><section><div><pre><code class="nohighlight">set_data!(calculation::DFCalculation, block_name::Symbol, new_block_data; option::Symbol=nothing, print::Bool=true)</code></pre><p>Searches for an <code>InputData</code> for which <code>InputData.name == block_name</code>, and sets <code>DFInput.data = new_block_data</code>. If <code>option</code> is specified it is set, i.e. <code>InputData.option = option</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L159-L164">source</a></section><section><div><pre><code class="nohighlight">set_data!(job::DFJob, calculations::Vector{&lt;:DFCalculation}, dataname::Symbol, data; option=nothing)</code></pre><p>Looks through the calculation filenames and sets the data of the datablock with <code>data_block_name</code> to <code>new_block_data</code>. if option is specified it will set the block option to it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/jobAPI.jl#L232-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_data_option!" href="#DFControl.set_data_option!"><code>DFControl.set_data_option!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_data_option!(calculation::DFCalculation, name::Symbol, option::Symbol; print=true)</code></pre><p>Searches for an <code>InputData</code> for which <code>InputData.name == block_name</code>, and sets <code>InputData.option = option</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L191-L195">source</a></section><section><div><pre><code class="nohighlight">set_data_option!(job::DFJob, names::Vector{String}, dataname::Symbol, option::Symbol)</code></pre><p>sets the option of specified data in the specified calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/jobAPI.jl#L248-L252">source</a></section><section><div><pre><code class="nohighlight">set_data_option!(job::DFJob, name::Symbol, option::Symbol)</code></pre><p>sets the option of specified data block in all calculations that have the block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/jobAPI.jl#L262-L266">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_kpoints!" href="#DFControl.set_kpoints!"><code>DFControl.set_kpoints!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_kpoints!(calculation::DFCalculation{QE}, k_grid::NTuple{3, Int}; print=true)
set_kpoints!(calculation::DFCalculation{QE}, k_grid::NTuple{6, Int}; print=true)
set_kpoints!(calculation::DFCalculation{QE}, k_grid::Vector{&lt;:NTuple{4}}; print=true, k_option=:crystal_b)</code></pre><p>Convenience function to set the <code>:k_points</code> data block of <code>calculation</code>. The three different methods are targeted at <code>nscf</code>, <code>scf</code> or <code>vcrelax</code>, and <code>bands</code> calculations, respectively. For the <code>nscf</code> version an explicit list of <code>k_points</code> will be generated.</p><pre><code class="nohighlight">set_kpoints!(calculation::DFCalculation{Wannier90}, k_grid::NTuple{3, Int})</code></pre><p>Similar to the <code>nscf</code> targeted function in the sense that it will generate an explicit list of <code>k_points</code>, adhering to the same rules as for the <code>nscf</code>. The <code>mp_grid</code> flag will also automatically be set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L295-L310">source</a></section></article><h2 id="Flags"><a class="docs-heading-anchor" href="#Flags">Flags</a><a id="Flags-1"></a><a class="docs-heading-anchor-permalink" href="#Flags" title="Permalink"></a></h2><p>A big part of working with DFT calculations is specifying the various calculation flags. Remembering all the names of the flags, where they belong, and what types they are expected to be, is quite complicated and can lead to easily made mistakes like typos. DFControl tries to catch these as it knows which flags are allowed for which calculations. It will report when a flag can not be found for a given <a href="#Calculations"><code>DFCalculation</code></a>, and it will also try to convert a flag value to the expected type.</p><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Tuple{DFCalculation, Symbol}" href="#Base.getindex-Tuple{DFCalculation, Symbol}"><code>Base.getindex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">getindex(calculation::DFCalculation, n::Symbol)</code></pre><p>Returns the flag with given symbol.</p><pre><code class="nohighlight">getindex(job::DFJob, flag::Symbol)</code></pre><p>Searches through the job&#39;s calculations for the requested flag. A <code>Dict</code> will be returned with calculation names as the keys and the flags as values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L18-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.setindex!-Tuple{DFCalculation, Symbol, Any}" href="#Base.setindex!-Tuple{DFCalculation, Symbol, Any}"><code>Base.setindex!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setindex!(calculation::DFCalculation, value, flag::Symbol)</code></pre><p>Sets flags.</p><pre><code class="nohighlight">setindex!(job::DFJob, value, flag::Symbol)</code></pre><p>Set <code>flag</code> in all the appropriate calculations to the <code>value</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L47-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_flags!" href="#DFControl.set_flags!"><code>DFControl.set_flags!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_flags!(calculation::DFCalculation, flags::Pair{Symbol, Any}...; print=true)</code></pre><p>Sets multiple flags in one go. Flag validity and type are verified.</p><pre><code class="nohighlight">set_flags!(job::DFJob, calculations::Vector{&lt;:DFCalculation}, flags::Pair{Symbol,&lt;:Any}...; print=true)
set_flags!(job::DFJob, flags::Pair{Symbol,&lt;:Any}...; print=true)</code></pre><p>Sets the flags in the names to the flags specified. This only happens if the specified flags are valid for the names.</p><p>The values that are supplied will be checked whether they are valid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L64-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.rm_flags!" href="#DFControl.rm_flags!"><code>DFControl.rm_flags!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rm_flags!(calculation::DFCalculation, flags::Symbol...)
rm_flags!(job::DFJob, flags::Symbol...)</code></pre><p>Remove the specified flags.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L129-L134">source</a></section></article><h2 id="Execs"><a class="docs-heading-anchor" href="#Execs">Execs</a><a id="Execs-1"></a><a class="docs-heading-anchor-permalink" href="#Execs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.Exec" href="#DFControl.Exec"><code>DFControl.Exec</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Exec(;exec::String = &quot;&quot;, dir::String = &quot;&quot;, flags::Vector{ExecFlag} = ExecFlag[])</code></pre><p>Representation of an <code>executable</code> that will run the <a href="#DFControl.DFCalculation"><code>DFCalculation</code></a>. Basically <code>dir/exec --&lt;flags&gt;</code> inside a job script.</p><pre><code class="nohighlight">Exec(exec::String, dir::String, flags::Pair{Symbol}...)</code></pre><p>Will first transform <code>flags</code> into a <code>Vector{ExecFlag}</code>, and construct the <a href="#DFControl.Exec"><code>Exec</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/types.jl#L171-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.exec" href="#DFControl.exec"><code>DFControl.exec</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">exec(calculation::DFCalculation, exec::String)
exec(job::DFJob, exec::String)</code></pre><p>Convenience function that returns the first executable in <code>calculation</code> or <code>job</code> for which <code>exec</code> occursin the name.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/execs.jl#L220-L226">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.execs" href="#DFControl.execs"><code>DFControl.execs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">execs(calculation::DFCalculation, exec::String)
execs(job::DFJob, exec::String)</code></pre><p>Convenience function to filter all executables in <code>calculation</code> or <code>job</code> for which <code>exec</code> occurs in the executable name.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/execs.jl#L207-L212">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_execdir!" href="#DFControl.set_execdir!"><code>DFControl.set_execdir!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_execdir!(calculation::DFCalculation, exec::String, dir::String)
set_execdir!(job::DFJob, exec::String, dir::String)</code></pre><p>Goes through the execs in <code>calculation</code> or <code>job</code> and sets the <code>dir</code> if the executable name contains <code>exec</code>.</p><p>Example:</p><pre><code class="language-julia">set_execdir!(calculation, &quot;pw.x&quot;, &quot;/path/to/QE/bin&quot;)
set_execdir!(job, &quot;pw.x&quot;, &quot;/path/to/QE/bin&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/execs.jl#L99-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.set_execflags!" href="#DFControl.set_execflags!"><code>DFControl.set_execflags!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">set_execflags!(calculation::DFCalculation, exec::String, flags::Pair...)
set_execflags!(job::DFJob, exec::String, flags::Pair...)</code></pre><p>Goes through the execs in <code>calculation</code> or <code>job</code> and sets the <code>flags</code> if the executable name contains <code>exec</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/execs.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.rm_execflags!" href="#DFControl.rm_execflags!"><code>DFControl.rm_execflags!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rm_execflags!(calculation::DFCalculation, exec::String, flags...)
rm_execflags!(job::DFJob, exec::String, flags...)</code></pre><p>Goes through the execs in <code>calculation</code> or <code>job</code> and removes the <code>flags</code> if the executable name contains <code>exec</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/execs.jl#L82-L88">source</a></section></article><h2 id="calculation_generation"><a class="docs-heading-anchor" href="#calculation_generation">Generating new calculations</a><a id="calculation_generation-1"></a><a class="docs-heading-anchor-permalink" href="#calculation_generation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_vcrelax-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}" href="#DFControl.gencalc_vcrelax-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_vcrelax</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gencalc_vcrelax(template::DFCalculation{QE}, kpoints::NTuple{6, Int}, newflags...; name=&quot;scf&quot;)</code></pre><p>Uses the information from the template and supplied <code>kpoints</code> to generate a vcrelax calculation. Extra flags can be supplied which will be set for the generated calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L289-L294">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_scf-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}" href="#DFControl.gencalc_scf-Tuple{DFCalculation{QE}, NTuple{6, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_scf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gencalc_scf(template::DFCalculation{QE}, kpoints::NTuple{6, Int}, newflags...; name=&quot;scf&quot;)</code></pre><p>Uses the information from the template and <code>supplied</code> kpoints to generate an scf calculation. Extra flags can be supplied which will be set for the generated calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L277-L282">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_bands-Tuple{DFCalculation{QE}, Vector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:(NTuple{4, T} where T), Vararg{Any, N} where N}" href="#DFControl.gencalc_bands-Tuple{DFCalculation{QE}, Vector{var&quot;#s3&quot;} where var&quot;#s3&quot;&lt;:(NTuple{4, T} where T), Vararg{Any, N} where N}"><code>DFControl.gencalc_bands</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gencalc_bands(template::DFCalculation{QE}, kpoints::Vector{NTuple{4}}, newflags...; name=&quot;bands&quot;)</code></pre><p>Uses the information from the template and supplied <code>kpoints</code> to generate a bands calculation. Extra flags can be supplied which will be set for the generated calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L301-L306">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_nscf-Tuple{DFCalculation{QE}, Tuple{Int64, Int64, Int64}, Vararg{Any, N} where N}" href="#DFControl.gencalc_nscf-Tuple{DFCalculation{QE}, Tuple{Int64, Int64, Int64}, Vararg{Any, N} where N}"><code>DFControl.gencalc_nscf</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gencalc_nscf(template::DFCalculation{QE}, kpoints::NTuple{3, Int}, newflags...; name=&quot;nscf&quot;)</code></pre><p>Uses the information from the template and supplied <code>kpoints</code> to generate an nscf calculation. Extra flags can be supplied which will be set for the generated calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L313-L318">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_projwfc-Tuple{DFCalculation{QE}, Real, Real, Real}" href="#DFControl.gencalc_projwfc-Tuple{DFCalculation{QE}, Real, Real, Real}"><code>DFControl.gencalc_projwfc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">gencalc_projwfc(template::DFCalculation{QE}, Emin, Emax, DeltaE, newflags...; name=&quot;projwfc&quot;)</code></pre><p>Uses the information from the template and supplied <code>kpoints</code> to generate a <code>projwfc.x</code> calculation. Extra flags can be supplied which will be set for the generated calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L325-L330">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.gencalc_wan" href="#DFControl.gencalc_wan"><code>DFControl.gencalc_wan</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gencalc_wan(nscf::DFCalculation{QE}, structure::AbstractStructure, Emin, wanflags...;
            Epad     = 5.0,
            wanexec  = Exec(exec=&quot;wannier90.x&quot;, dir=&quot;&quot;))</code></pre><p>Generates a Wannier90 calculation to follow on the supplied <code>nscf</code> calculation. It uses the projections defined in the <code>structure</code>, and starts counting the required amount of bands from <code>Emin</code>. The <code>nscf</code> needs to have a valid output since it will be used in conjunction with <code>Emin</code> to find the required amount of bands and energy window for the Wannier90 calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L363-L370">source</a></section><section><div><pre><code class="nohighlight">gencalc_wan(nscf::DFCalculation{QE}, structure::AbstractStructure, projwfc::DFCalculation{QE}, threshold::Real, wanflags...; kwargs...)</code></pre><p>Generates a wannier calculation, that follows on the <code>nscf</code> calculation. Instead of passing Emin manually, the output of a projwfc.x run can be used together with a <code>threshold</code> to determine the minimum energy such that the contribution of the projections to the DOS is above the <code>threshold</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/qe/calculation.jl#L420-L426">source</a></section><section><div><pre><code class="nohighlight">gencalc_wan(job::DFJob, min_window_determinator::Real, extra_wan_flags...; kwargs...)</code></pre><p>Automates the generation of wannier calculations based on the <code>job</code>. When a projwfc calculation is present in the <code>job</code>, <code>min_window_determinator</code> will be used to determine the threshold value for including a band in the window based on the projections, otherwise it will be used as the <code>Emin</code> value from which to start counting the number of bands needed for all projections. <code>extra_wan_flags</code> can be any extra flags for the Wannier90 calculation such as <code>write_hr</code> etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/jobAPI.jl#L412-L421">source</a></section></article><h2 id="Output"><a class="docs-heading-anchor" href="#Output">Output</a><a id="Output-1"></a><a class="docs-heading-anchor-permalink" href="#Output" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DFControl.outputdata" href="#DFControl.outputdata"><code>DFControl.outputdata</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">outputdata(calculation::DFCalculation; extra_parse_funcs=[], print=true, overwrite=true)</code></pre><p>If an output file exists for <code>calculation</code> this will parse it and return a <code>Dict</code> with the parsed data. If <code>overwrite=false</code> and <code>calculation.outputdata</code> is not empty, this will be returned instead of reparsing the output file.</p><p><code>extra_parse_funcs</code> should be <code>Vector{Pair{String,Function}}</code>, where the string will be used to match <code>occursin(str, line)</code> for each line of the output file. If this returns <code>true</code>, the function will be called as <code>func(results_dict, line, file)</code>. The purpose is to allow for additional parsing that is not implemented, or for temporary non-standard values that are printed while working on the DFT code, e.g. for debugging.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This only works for files where not all information is pulled out for yet, e.g. projwfc.x outputs are fully parsed already.</p></div></div><p>Example (from src/qe/fileio.jl):</p><pre><code class="language-julia">
function qe_parse_nat(results, line, f)
    results[:nat] = parse(Int, split(line)[end])
end

outputdata(job[&quot;scf&quot;], extra_parse_funcs = [&quot;number of atoms/cell&quot; =&gt; qe_parse_nat])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L209-L234">source</a></section><section><div><p>Finds the output files for each of the calculations of a job, and groups all found data into a dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/jobAPI.jl#L271">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.readfermi" href="#DFControl.readfermi"><code>DFControl.readfermi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">readfermi(calculation::DFCalculation)</code></pre><p>Parses the <code>outputdata</code> associated with <code>calculation</code> and returns the fermi level if present.</p><pre><code class="nohighlight">readfermi(job::DFJob)</code></pre><p>Finds the first <code>scf</code> calculation present in the <code>job</code>, reads its <code>outputdata</code> and returns the fermi level if present.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L275-L284">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="DFControl.readbands" href="#DFControl.readbands"><code>DFControl.readbands</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">readbands(calculation::DFCalculation)</code></pre><p>Parses the <code>outputdata</code> associated with <code>calculation</code> and returns the bands if present.</p><pre><code class="nohighlight">readbands(job::DFJob)</code></pre><p>Will try to find the first bandstructure calculation present in the <code>job</code> with a valid output file, and return the <code>bands</code> if present. If no normal bandstructure calculation is present, it will return the bands produced by a possible <code>nscf</code> calculation if one exists with a valid output file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/louisponet/DFControl.jl/blob/4fce67d38d1ed9bd6b30a0c03e4b311464a5e1b2/src/calculationAPI.jl#L251-L262">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../jobs/">« Jobs</a><a class="docs-footer-nextpage" href="../structure/">Structure »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 24 June 2021 20:05">Thursday 24 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
